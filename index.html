<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <!-- Crucial for mobile responsiveness -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Moray</title>
  <link rel="stylesheet" href="style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
  
  <div class="background-gradient"></div>

  <header>
    <div class="header-content">
      <h1>MORAY</h1>
      <div class="header-right hidden" id="appHeader">
        <span id="userEmailLabel" class="user-email"></span>
        
        <nav class="nav-menu">
          <button id="navAdd" class="btn active-tab">Add</button>
          <button id="navToWatch" class="btn secondary">To Watch</button>
          <button id="navWatched" class="btn secondary">Watched</button>
          <button id="logoutBtn" class="btn logout-btn" style="display:none;">Logout</button>
        </nav>
      </div>
    </div>
  </header>

  <main>
    <!-- Auth section -->
    <section id="authSection" class="card auth-card">
      <div class="card-content">
        <h2>Welcome Back</h2>
        <p class="auth-subtitle">Track your movie journey.</p>

        <div class="auth-tabs">
          <button class="btn small auth-tab active" data-mode="login">Login</button>
          <button class="btn small auth-tab" data-mode="signup">Sign up</button>
        </div>

        <form id="authForm">
          <div class="form-row">
            <div class="field">
              <label for="authEmail">Email</label>
              <input type="email" id="authEmail" required placeholder="name@example.com" />
            </div>
          </div>
          <div class="form-row">
            <div class="field">
              <label for="authPassword">Password</label>
              <input type="password" id="authPassword" required placeholder="••••••••" />
            </div>
          </div>
          <div class="form-row submit-row">
            <button type="submit" class="btn primary full-width" id="authSubmitBtn">Login</button>
          </div>
          <p id="authError" class="auth-error"></p>
        </form>
      </div>
    </section>

    <!-- App section -->
    <section id="appSection" class="hidden">

      <!-- ADD PAGE -->
      <section id="pageAdd" class="page-section fade-in">
        <section id="addMovieSection" class="card">
          <div class="card-header">
            <h2>Add New Title</h2>
          </div>

          <div class="form-grid">
            <div class="form-main">
              <div class="form-row full-width">
                <div class="field suggestions">
                  <label for="searchInput">Search Online (OMDb)</label>
                  <input type="text" id="searchInput" placeholder="Search for a movie..." autocomplete="off" />
                  <div id="suggestionsList" style="display:none;"></div>
                </div>
              </div>

              <div class="form-row two-col">
                <div class="field">
                  <label for="titleInput">Title</label>
                  <input type="text" id="titleInput" placeholder="Movie Title" />
                </div>
                <div class="field">
                  <label for="yearInput">Year</label>
                  <input type="number" id="yearInput" placeholder="2024" />
                </div>
              </div>

              <div class="form-row two-col">
                <div class="field">
                  <label for="typeSelect">Type</label>
                  <select id="typeSelect">
                    <option value="movie">Movie</option>
                    <option value="series">Series</option>
                  </select>
                </div>
                <div class="field">
                  <label for="genreInput">Genre</label>
                  <input type="text" id="genreInput" placeholder="Action, Drama..." />
                </div>
              </div>

              <div class="form-row two-col">
                 <div class="field">
                  <label for="statusSelect">List</label>
                  <select id="statusSelect">
                    <option value="toWatch">To Watch</option>
                    <option value="watched">Watched</option>
                  </select>
                </div>
              </div>

              <div class="form-row">
                <div class="field">
                  <label for="reviewInput">Notes / Review</label>
                  <textarea id="reviewInput" placeholder="Why do you want to watch this?"></textarea>
                </div>
              </div>
            </div>

            <!-- Poster Side -->
            <div class="poster-section">
              <label>Poster</label>
              <div class="poster-container">
                <img id="posterPreview" src="placeholder.png" alt="Poster preview" />
              </div>
              <span class="poster-help">Auto-filled from search</span>
            </div>
          </div>

          <div class="form-actions">
            <button id="addMovieBtn" class="btn primary icon-btn">
              <span>Save Title</span>
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path><polyline points="17 21 17 13 7 13 7 21"></polyline><polyline points="7 3 7 8 15 8"></polyline></svg>
            </button>
          </div>
        </section>
      </section>

      <!-- TO WATCH PAGE -->
      <section id="pageToWatch" class="page-section fade-in hidden">
        <div class="list-container">
          <div class="list-header">
            <h2>To Watch List</h2>
            <span id="unwatchedCount" class="badge">0</span>
          </div>
          <div id="unwatchedList" class="movie-grid"></div>
        </div>
      </section>

      <!-- WATCHED PAGE -->
      <section id="pageWatched" class="page-section fade-in hidden">
        <div class="list-container">
          <div class="list-header">
            <h2>Watched History</h2>
            <span id="watchedCount" class="badge">0</span>
          </div>
          <div id="watchedList" class="movie-grid"></div>
        </div>
      </section>

    </section>
  </main>

  <!-- Supabase SDK & Script -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="script.js"></script>
</body>
</html>